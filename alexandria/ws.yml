info:
  title: EMenu
  description: WebSocket документация
  version: 0.1.0

server:
  url: ws://0.0.0.0:8000/ws/restaurant/<restaurant_id>/
  description: <restaurant_id> - Идентификатор ресторана. Так же в запросе в заголовке `cookie`, передается token, который является access токеном

actions:
  connect:
    description: Подключение к комнате
    actor:
      type: object
      properties:
        is_system: true
        description: Connect будет запускаться только по запросу на соединение и обрабатываться серверной частью
    response_to_user:
      event: list_orders
      orders:
        type: array
        items:
          type: object
          properties:
            id:
              type: integer
            status:
              type: string
            comment:
              type: string
            employee:
              type: object
              properties:
                id:
                  type: number
                role:
                  type: string
                first_name:
                  type: string
                last_name:
                  type: string
                surname:
                  type: string
                restaurant:
                  type: number
            client:
              type: object
              properties:
                id:
                  type: number
                first_name:
                  type: string
                last_name:
                  type: string
                surname:
                  type: string
                bonuses:
                  type: number
              nullable: true
            dishes:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: number
                  status:
                    type: string
                  order:
                    type: number
                  count:
                    type: number
                  dish:
                    type: object
                    properties:
                      id: 
                        type: number
                      category:
                        type: object
                        properties:
                          id:
                            type: number
                          name:
                            type: string
                      name:
                        type: string
                      description:
                        type: string
                      short_description:
                        type: string
                      price:
                        type: string
                      compound:
                        type: string
                      weight:
                        type: string
                      images:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: number
                            image:
                              type: string
                  comment:
                    type: string
                  employee:
                    type: object
                    properties:
                      id:
                        type: number
                      role:
                        type: string
                      first_name:
                        type: string
                      last_name:
                        type: string
                      surname:
                        type: string
                      restaurant:
                        type: number
            price:
              type: string
  
  employee_orders_list:
    description: Получение списка заказов
    actor:
      type: object
      properties:
        is_system: true
        description: employee_orders_list будет запускаться при подключении сотрудника к комнате, при наличии новых или обновленных заказов. Так же, его можно вызывать при необходимости самому
    response_to_user:
      event: list_orders
      orders:
        type: object
        properties:
          id:
            type: integer
          status:
            type: string
          comment:
            type: string
          employee:
            type: object
            properties:
              id:
                type: number
              role:
                type: string
              first_name:
                type: string
              last_name:
                type: string
              surname:
                type: string
              restaurant:
                type: number
          client:
            type: object
            properties:
              id:
                type: number
              first_name:
                type: string
              last_name:
                type: string
              surname:
                type: string
              bonuses:
                type: number
            nullable: true
          dishes:
            type: array
            items:
              type: object
              properties:
                id:
                  type: number
                status:
                  type: string
                order:
                  type: number
                dish:
                  type: object
                  properties:
                    id: 
                      type: number
                    category:
                      type: object
                      properties:
                        id:
                          type: number
                        name:
                          type: string
                    name:
                      type: string
                    description:
                      type: string
                    short_description:
                      type: string
                    price:
                      type: string
                    compound:
                      type: string
                    weight:
                      type: string
                    images:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: number
                          image:
                            type: string
                comment:
                  type: string
                count:
                  type: integer
                employee:
                  type: object
                  properties:
                    id:
                      type: number
                    role:
                      type: string
                    first_name:
                      type: string
                    last_name:
                      type: string
                    surname:
                      type: string
                    restaurant:
                      type: number
          price:
            type: string

  create_order:
    description: Создание нового заказа
    actor:
      type: object
      properties:
        is_system: false
    data:
      type: object
      properties:
        status:
          type: string
          nullable: true
        comment:
          type: string
        client:
          type: number
          nullable: true
        dishes:
          type: array
          items:
            type: object
            properties:
              dish:
                type: integer
              comment:
                type: string
              count:
                type: integer
        reservation:
          type: number
    response_to_group:
      event: list_orders
      orders:
        type: array
        items:
          type: object
          properties:
            id:
              type: integer
            status:
              type: string
            comment:
              type: string
            employee:
              type: object
              properties:
                id:
                  type: number
                role:
                  type: string
                first_name:
                  type: string
                last_name:
                  type: string
                surname:
                  type: string
                restaurant:
                  type: number
            client:
              type: object
              properties:
                id:
                  type: number
                first_name:
                  type: string
                last_name:
                  type: string
                surname:
                  type: string
                bonuses:
                  type: number
              nullable: true
            dishes:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: number
                  status:
                    type: string
                  order:
                    type: number
                  dish:
                    type: object
                    properties:
                      id: 
                        type: number
                      category:
                        type: object
                        properties:
                          id:
                            type: number
                          name:
                            type: string
                      name:
                        type: string
                      description:
                        type: string
                      short_description:
                        type: string
                      price:
                        type: string
                      compound:
                        type: string
                      weight:
                        type: string
                      images:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: number
                            image:
                              type: string
                comment:
                  type: string
                count:
                  type: integer
                employee:
                  type: object
                  properties:
                    id:
                      type: number
                    role:
                      type: string
                    first_name:
                      type: string
                    last_name:
                      type: string
                    surname:
                      type: string
                    restaurant:
                      type: number
            price:
              type: string

  edit_order:
    description: Изменение заказа
    actor:
      type: object
      properties:
        is_system: false
    data:
      type: object
      properties:
        id:
          type: number
          nullable: true
        status:
          type: string
        comment:
          type: string
        client:
          type: number
          nullable: true
        employee:
          type: number
          nullable: true
        dishes:
          type: array
          nullable: true
          items:
            type: object
            properties:
              id:
                type: number
                nullable: true
              status:
                type: string
                nullable: true
              dish:
                type: number
              comment:
                type: string
                nullable: true
              count:
                type: integer
                nullable: true
              employee:
                type: number
                nullable: true
    response_to_group:
      event: list_orders
      orders:
        type: array
        items:
          type: object
          properties:
            id:
              type: integer
            status:
              type: string
            comment:
              type: string
            employee:
              type: object
              properties:
                id:
                  type: number
                role:
                  type: string
                first_name:
                  type: string
                last_name:
                  type: string
                surname:
                  type: string
                restaurant:
                  type: number
            client:
              type: object
              properties:
                id:
                  type: number
                first_name:
                  type: string
                last_name:
                  type: string
                surname:
                  type: string
                bonuses:
                  type: number
              nullable: true
            dishes:
              type: array
              items:
                type: array
                properties:
                  id:
                    type: number
                  status:
                    type: string
                  order:
                    type: number
                  dish:
                    type: object
                    properties:
                      id: 
                        type: number
                      category:
                        type: object
                        properties:
                          id:
                            type: number
                          name:
                            type: string
                      name:
                        type: string
                      description:
                        type: string
                      short_description:
                        type: string
                      price:
                        type: string
                      compound:
                        type: string
                      weight:
                        type: string
                      images:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: number
                            image:
                              type: string
                comment:
                  type: string
                count:
                  type: string
                employee:
                  type: object
                  properties:
                    id:
                      type: number
                    role:
                      type: string
                    first_name:
                      type: string
                    last_name:
                      type: string
                    surname:
                      type: string
                    restaurant:
                      type: number
            price:
              type: string
